<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/4429ecc4621a693b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4429ecc4621a693b.css" data-n-g=""/><link rel="preload" href="/_next/static/css/529f96ead43caf4a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/529f96ead43caf4a.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-c85490a6f758d8f5.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-01df828e572375b9.js" defer=""></script><script src="/_next/static/chunks/pages/_app-10f1138d034d1cff.js" defer=""></script><script src="/_next/static/chunks/685-4f1385d546b7038a.js" defer=""></script><script src="/_next/static/chunks/338-eda78c6b31a9753f.js" defer=""></script><script src="/_next/static/chunks/pages/bits/toc-e5fefdebe322f604.js" defer=""></script><script src="/_next/static/HFqsTIh8NfeB1KISpc7lS/_buildManifest.js" defer=""></script><script src="/_next/static/HFqsTIh8NfeB1KISpc7lS/_ssgManifest.js" defer=""></script><script src="/_next/static/HFqsTIh8NfeB1KISpc7lS/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><nav class="navBarLayout_nav__yApjk"><a class="" href="/">Home</a><a class="" href="/about">About</a><a class="" href="/projects">Projects</a></nav><main><div class="tableOfContentsLayout_container__EzUwh"><div class="tableOfContentsLayout_content__KYkIj"><h1 class="mdxPageLayout_title__J15LR">Table of contents</h1><p>I wanted to display a list of all headings on my page. This is commonly known as a &quot;table of contents&quot;.
After looking around online, I found an algorithm that was able to generate a TOC (<strong>t</strong>able <strong>o</strong>f <strong>c</strong>ontents) from a list of headings. Although only up to two levels deep. So H1s and H2s.</p>
<h1 id="old-algorithm">Old algorithm</h1>
<p>I don&#x27;t remember where I got the idea from, but here is the code. It&#x27;s more for completeness sake anyway.</p>
<pre><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code class="language-typescript" style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#96CBFE">function</span><span> </span><span class="token" style="color:#DAD085">generateHeadingsTreeFrom</span><span class="token" style="color:#c5c8c6">(</span><span>
</span><span>    headingElements</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">HTMLHeadingElement</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">,</span><span>
</span><span></span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">Heading</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>    </span><span class="token" style="color:#96CBFE">const</span><span> headings</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">Heading</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span> </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">;</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#96CBFE">for</span><span> </span><span class="token" style="color:#c5c8c6">(</span><span class="token" style="color:#96CBFE">const</span><span> headingElement </span><span class="token" style="color:#96CBFE">of</span><span> headingElements</span><span class="token" style="color:#c5c8c6">)</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>        </span><span class="token" style="color:#96CBFE">const</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span> innerText</span><span class="token" style="color:#EDEDED">:</span><span> text</span><span class="token" style="color:#c5c8c6">,</span><span> id</span><span class="token" style="color:#c5c8c6">,</span><span> nodeName </span><span class="token" style="color:#c5c8c6">}</span><span> </span><span class="token" style="color:#EDEDED">=</span><span> headingElement</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>        </span><span class="token" style="color:#96CBFE">const</span><span> heading</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">Heading</span><span> </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span> children</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">,</span><span> id</span><span class="token" style="color:#c5c8c6">,</span><span> text </span><span class="token" style="color:#c5c8c6">}</span><span class="token" style="color:#c5c8c6">;</span><span>
</span>
<span>        </span><span class="token control-flow" style="color:#96CBFE">if</span><span> </span><span class="token" style="color:#c5c8c6">(</span><span>nodeName </span><span class="token" style="color:#EDEDED">===</span><span> </span><span class="token" style="color:#A8FF60">&quot;H1&quot;</span><span class="token" style="color:#c5c8c6">)</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>            headings</span><span class="token" style="color:#c5c8c6">.</span><span class="token method property-access" style="color:#DAD085">push</span><span class="token" style="color:#c5c8c6">(</span><span>heading</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>        </span><span class="token" style="color:#c5c8c6">}</span><span> </span><span class="token control-flow" style="color:#96CBFE">else</span><span> </span><span class="token control-flow" style="color:#96CBFE">if</span><span> </span><span class="token" style="color:#c5c8c6">(</span><span>nodeName </span><span class="token" style="color:#EDEDED">===</span><span> </span><span class="token" style="color:#A8FF60">&quot;H2&quot;</span><span> </span><span class="token" style="color:#EDEDED">&amp;&amp;</span><span> headings</span><span class="token" style="color:#c5c8c6">.</span><span class="token property-access">length</span><span> </span><span class="token" style="color:#EDEDED">&gt;</span><span> </span><span class="token" style="color:#FF73FD">0</span><span class="token" style="color:#c5c8c6">)</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>            headings</span><span class="token" style="color:#c5c8c6">[</span><span>headings</span><span class="token" style="color:#c5c8c6">.</span><span class="token property-access">length</span><span> </span><span class="token" style="color:#EDEDED">-</span><span> </span><span class="token" style="color:#FF73FD">1</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">.</span><span class="token property-access">children</span><span class="token" style="color:#c5c8c6">.</span><span class="token method property-access" style="color:#DAD085">push</span><span class="token" style="color:#c5c8c6">(</span><span>heading</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>        </span><span class="token" style="color:#c5c8c6">}</span><span>
</span><span>    </span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#96CBFE">return</span><span> headings</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span></span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
</code></pre></pre>
<h1 id="setup">Setup</h1>
<p>I wanted to create an algorithm that can handle any depth. Let&#x27;s go through my thought process on how to create this.</p>
<p>First, this is the code I use to get my heading elements:</p>
<pre><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code class="language-typescript" style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#96CBFE">const</span><span> headings </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token known-class-name" style="color:#FFFFB6;text-decoration:underline">Array</span><span class="token" style="color:#c5c8c6">.</span><span class="token module" style="color:#96CBFE">from</span><span class="token" style="color:#c5c8c6">(</span><span>
</span><span>    </span><span class="token dom" style="color:#C6C5FE">document</span><span class="token" style="color:#c5c8c6">.</span><span class="token method property-access" style="color:#DAD085">querySelectorAll</span><span class="token" style="color:#c5c8c6">(</span><span class="token" style="color:#A8FF60">&quot;h1, h2, h3, h4, h5, h6&quot;</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">,</span><span>
</span><span></span><span class="token" style="color:#c5c8c6">)</span><span> </span><span class="token module" style="color:#96CBFE">as</span><span> </span><span class="token maybe-class-name">HTMLHeadingElement</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">;</span><span> </span><span class="token" style="color:#7C7C7C">// I&#x27;m using typescript btw :)</span><span>
</span>
<span></span><span class="token" style="color:#96CBFE">const</span><span> tocTree </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token" style="color:#DAD085">createTocTreeFrom</span><span class="token" style="color:#c5c8c6">(</span><span>headings</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span> </span><span class="token" style="color:#7C7C7C">// This is the function to implement.</span><span>
</span>
</code></pre></pre>
<h1 id="toctreenode"><code>TocTreeNode</code></h1>
<p>Here is the <code>TocTreeNode</code> definition:</p>
<pre><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code class="language-typescript" style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#96CBFE">interface</span><span> </span><span class="token maybe-class-name" style="color:#FFFFB6;text-decoration:underline">TocTreeNode</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>    text</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token" style="color:#A8FF60">string</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>    children</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">TocTreeNode</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span></span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
</code></pre></pre>
<h1 id="new-any-depth-toc">New &quot;any depth&quot; toc</h1>
<pre><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code class="language-typescript" style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#96CBFE">function</span><span> </span><span class="token" style="color:#DAD085">createTocTreeFrom</span><span class="token" style="color:#c5c8c6">(</span><span>headings</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">HTMLHeadingElement</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">TocTreeNode</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>    </span><span class="token" style="color:#96CBFE">const</span><span> nodes</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">TocTreeNode</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span> </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">;</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#96CBFE">for</span><span> </span><span class="token" style="color:#c5c8c6">(</span><span class="token" style="color:#96CBFE">const</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span> tagName</span><span class="token" style="color:#c5c8c6">,</span><span> innerText</span><span class="token" style="color:#EDEDED">:</span><span> text </span><span class="token" style="color:#c5c8c6">}</span><span> </span><span class="token" style="color:#96CBFE">of</span><span> headings</span><span class="token" style="color:#c5c8c6">)</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>        </span><span class="token" style="color:#96CBFE">const</span><span> matches </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token" style="color:#99CC99">HEADING_TAG_REGEX</span><span class="token" style="color:#c5c8c6">.</span><span class="token method property-access" style="color:#DAD085">exec</span><span class="token" style="color:#c5c8c6">(</span><span>tagName</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span>
<span>        </span><span class="token control-flow" style="color:#96CBFE">if</span><span> </span><span class="token" style="color:#c5c8c6">(</span><span class="token" style="color:#EDEDED">!</span><span>matches</span><span class="token" style="color:#c5c8c6">)</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>            </span><span class="token control-flow" style="color:#96CBFE">continue</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>        </span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
<span>        </span><span class="token" style="color:#96CBFE">const</span><span> headingLvl </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token" style="color:#DAD085">parseInt</span><span class="token" style="color:#c5c8c6">(</span><span>matches</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#FF73FD">1</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span>
<span>        </span><span class="token control-flow" style="color:#96CBFE">if</span><span> </span><span class="token" style="color:#c5c8c6">(</span><span>headingLvl </span><span class="token" style="color:#EDEDED">!==</span><span> </span><span class="token" style="color:#FF73FD">1</span><span class="token" style="color:#c5c8c6">)</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>            </span><span class="token control-flow" style="color:#96CBFE">continue</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>        </span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
<span>        nodes</span><span class="token" style="color:#c5c8c6">.</span><span class="token method property-access" style="color:#DAD085">push</span><span class="token" style="color:#c5c8c6">(</span><span class="token" style="color:#c5c8c6">{</span><span> children</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">,</span><span> text </span><span class="token" style="color:#c5c8c6">}</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>    </span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#96CBFE">return</span><span> nodes</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span></span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
</code></pre></pre>
<p>The code above returns a simple list of all H1 elements.
So let&#x27;s step it up a notch. First, add an additional parameter <code>desiredLvl</code>,  so what we look for can be customized.</p>
<pre><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code class="language-typescript" style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#96CBFE">function</span><span> </span><span class="token" style="color:#DAD085">createTocTreeFrom</span><span class="token" style="color:#c5c8c6">(</span><span>
</span><span>    headings</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">HTMLHeadingElement</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">,</span><span>
</span><span>    desiredLvl</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token" style="color:#A8FF60">number</span><span class="token" style="color:#c5c8c6">,</span><span>
</span><span></span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">TocTreeNode</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>    </span><span class="token" style="color:#7C7C7C">// ....</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#96CBFE">if</span><span> </span><span class="token" style="color:#c5c8c6">(</span><span>headingLvl </span><span class="token" style="color:#EDEDED">!==</span><span> desiredLvl</span><span class="token" style="color:#c5c8c6">)</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>        </span><span class="token control-flow" style="color:#96CBFE">continue</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>    </span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
<span>    </span><span class="token" style="color:#7C7C7C">// ...</span><span>
</span><span></span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
</code></pre></pre>
<p>Let&#x27;s add depth to it, by actually providing something for the <code>children</code> attribute.  For now, let&#x27;s just call the function recursively, but one level deeper, so <code>desiredLvl + 1</code>. We also want to not include previous elements, as otherwise, we would loop indefinitely.</p>
<pre><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code class="language-typescript" style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#96CBFE">function</span><span> </span><span class="token" style="color:#DAD085">createTocTreeFrom</span><span class="token" style="color:#c5c8c6">(</span><span>
</span><span>    headings</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">HTMLHeadingElement</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">,</span><span>
</span><span>    desiredLvl</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token" style="color:#A8FF60">number</span><span class="token" style="color:#c5c8c6">,</span><span>
</span><span></span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">TocTreeNode</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>    </span><span class="token" style="color:#96CBFE">const</span><span> nodes</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">TocTreeNode</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span> </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">;</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#96CBFE">for</span><span> </span><span class="token" style="color:#c5c8c6">(</span><span class="token" style="color:#96CBFE">let</span><span> i </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token" style="color:#FF73FD">0</span><span class="token" style="color:#c5c8c6">;</span><span> i </span><span class="token" style="color:#EDEDED">&lt;</span><span> headings</span><span class="token" style="color:#c5c8c6">.</span><span class="token property-access">length</span><span class="token" style="color:#c5c8c6">;</span><span> i</span><span class="token" style="color:#EDEDED">++</span><span class="token" style="color:#c5c8c6">)</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>        </span><span class="token" style="color:#96CBFE">const</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span> tagName</span><span class="token" style="color:#c5c8c6">,</span><span> innerText</span><span class="token" style="color:#EDEDED">:</span><span> text </span><span class="token" style="color:#c5c8c6">}</span><span> </span><span class="token" style="color:#EDEDED">=</span><span> headings</span><span class="token" style="color:#c5c8c6">[</span><span>i</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>        </span><span class="token" style="color:#96CBFE">const</span><span> matches </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token" style="color:#99CC99">HEADING_TAG_REGEX</span><span class="token" style="color:#c5c8c6">.</span><span class="token method property-access" style="color:#DAD085">exec</span><span class="token" style="color:#c5c8c6">(</span><span>tagName</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span>
<span>        </span><span class="token control-flow" style="color:#96CBFE">if</span><span> </span><span class="token" style="color:#c5c8c6">(</span><span class="token" style="color:#EDEDED">!</span><span>matches</span><span class="token" style="color:#c5c8c6">)</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>            </span><span class="token control-flow" style="color:#96CBFE">continue</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>        </span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
<span>        </span><span class="token" style="color:#96CBFE">const</span><span> headingLvl </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token" style="color:#DAD085">parseInt</span><span class="token" style="color:#c5c8c6">(</span><span>matches</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#FF73FD">1</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span>
<span>        </span><span class="token control-flow" style="color:#96CBFE">if</span><span> </span><span class="token" style="color:#c5c8c6">(</span><span>headingLvl </span><span class="token" style="color:#EDEDED">!==</span><span> desiredLvl</span><span class="token" style="color:#c5c8c6">)</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>            </span><span class="token control-flow" style="color:#96CBFE">continue</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>        </span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
<span>        </span><span class="token" style="color:#96CBFE">const</span><span> children </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token" style="color:#DAD085">createTocTreeFrom</span><span class="token" style="color:#c5c8c6">(</span><span>headings</span><span class="token" style="color:#c5c8c6">.</span><span class="token method property-access" style="color:#DAD085">slice</span><span class="token" style="color:#c5c8c6">(</span><span>i </span><span class="token" style="color:#EDEDED">+</span><span> </span><span class="token" style="color:#FF73FD">1</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">,</span><span> desiredLvl </span><span class="token" style="color:#EDEDED">+</span><span> </span><span class="token" style="color:#FF73FD">1</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span>
<span>        nodes</span><span class="token" style="color:#c5c8c6">.</span><span class="token method property-access" style="color:#DAD085">push</span><span class="token" style="color:#c5c8c6">(</span><span class="token" style="color:#c5c8c6">{</span><span> children</span><span class="token" style="color:#c5c8c6">,</span><span> text </span><span class="token" style="color:#c5c8c6">}</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>    </span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#96CBFE">return</span><span> nodes</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span></span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
</code></pre></pre>
<p>But this algorithm is flawed. Consider the following headings:</p>
<pre><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code class="language-html" style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#c5c8c6">&lt;</span><span class="token" style="color:#96CBFE">h1</span><span class="token" style="color:#c5c8c6">&gt;</span><span>1</span><span class="token" style="color:#c5c8c6">&lt;/</span><span class="token" style="color:#96CBFE">h1</span><span class="token" style="color:#c5c8c6">&gt;</span><span>
</span><span></span><span class="token" style="color:#c5c8c6">&lt;</span><span class="token" style="color:#96CBFE">h2</span><span class="token" style="color:#c5c8c6">&gt;</span><span>1.1</span><span class="token" style="color:#c5c8c6">&lt;/</span><span class="token" style="color:#96CBFE">h2</span><span class="token" style="color:#c5c8c6">&gt;</span><span>
</span><span></span><span class="token" style="color:#c5c8c6">&lt;</span><span class="token" style="color:#96CBFE">h1</span><span class="token" style="color:#c5c8c6">&gt;</span><span>2</span><span class="token" style="color:#c5c8c6">&lt;/</span><span class="token" style="color:#96CBFE">h1</span><span class="token" style="color:#c5c8c6">&gt;</span><span>
</span><span></span><span class="token" style="color:#c5c8c6">&lt;</span><span class="token" style="color:#96CBFE">h2</span><span class="token" style="color:#c5c8c6">&gt;</span><span>2.1</span><span class="token" style="color:#c5c8c6">&lt;/</span><span class="token" style="color:#96CBFE">h2</span><span class="token" style="color:#c5c8c6">&gt;</span><span>
</span>
</code></pre></pre>
<p>The output would be:</p>
<pre><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code class="language-text" style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>- 1
</span>  children:
<!-- -->    - 1.1
<!-- -->    - 2.1
<!-- -->- 2
<!-- -->  children:
<!-- -->    - 2.1
<!-- -->
</code></pre></pre>
<p>As you can see, the heading <strong>2.1</strong> is listed under the heading <strong>1</strong>, which is quite incorrect. This happens because we never considered the hierarchy of the headings, and just added all smaller headings to the bigger ones.</p>
<p>Luckily, this is a relatively simple fix. Instead of just checking if the heading has the desired level and then adding it, we now also check if the heading is actually bigger than the current one. If it&#x27;s bigger, all the next elements are of no concern to us, so we can simply return from the function.</p>
<p>This final algorithm is:</p>
<pre><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code class="language-typescript" style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#96CBFE">function</span><span> </span><span class="token" style="color:#DAD085">createTocTreeFrom</span><span class="token" style="color:#c5c8c6">(</span><span>
</span><span>    headings</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">HTMLHeadingElement</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">,</span><span>
</span><span>    desiredLvl</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token" style="color:#A8FF60">number</span><span class="token" style="color:#c5c8c6">,</span><span>
</span><span></span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">TocTreeNode</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>    </span><span class="token" style="color:#96CBFE">const</span><span> nodes</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">TocTreeNode</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span> </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">;</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#96CBFE">for</span><span> </span><span class="token" style="color:#c5c8c6">(</span><span class="token" style="color:#96CBFE">let</span><span> i </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token" style="color:#FF73FD">0</span><span class="token" style="color:#c5c8c6">;</span><span> i </span><span class="token" style="color:#EDEDED">&lt;</span><span> headings</span><span class="token" style="color:#c5c8c6">.</span><span class="token property-access">length</span><span class="token" style="color:#c5c8c6">;</span><span> i</span><span class="token" style="color:#EDEDED">++</span><span class="token" style="color:#c5c8c6">)</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>        </span><span class="token" style="color:#96CBFE">const</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span> tagName</span><span class="token" style="color:#c5c8c6">,</span><span> innerText</span><span class="token" style="color:#EDEDED">:</span><span> text </span><span class="token" style="color:#c5c8c6">}</span><span> </span><span class="token" style="color:#EDEDED">=</span><span> headings</span><span class="token" style="color:#c5c8c6">[</span><span>i</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>        </span><span class="token" style="color:#96CBFE">const</span><span> matches </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token" style="color:#99CC99">HEADING_TAG_REGEX</span><span class="token" style="color:#c5c8c6">.</span><span class="token method property-access" style="color:#DAD085">exec</span><span class="token" style="color:#c5c8c6">(</span><span>tagName</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span>
<span>        </span><span class="token control-flow" style="color:#96CBFE">if</span><span> </span><span class="token" style="color:#c5c8c6">(</span><span class="token" style="color:#EDEDED">!</span><span>matches</span><span class="token" style="color:#c5c8c6">)</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>            </span><span class="token control-flow" style="color:#96CBFE">continue</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>        </span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
<span>        </span><span class="token" style="color:#96CBFE">const</span><span> headingLvl </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token" style="color:#DAD085">parseInt</span><span class="token" style="color:#c5c8c6">(</span><span>matches</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#FF73FD">1</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>        </span><span class="token" style="color:#96CBFE">const</span><span> node</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">TocTreeNode</span><span> </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span> children</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">,</span><span> text </span><span class="token" style="color:#c5c8c6">}</span><span class="token" style="color:#c5c8c6">;</span><span>
</span>
<span>        </span><span class="token control-flow" style="color:#96CBFE">if</span><span> </span><span class="token" style="color:#c5c8c6">(</span><span>headingLvl </span><span class="token" style="color:#EDEDED">&lt;</span><span> desiredLvl</span><span class="token" style="color:#c5c8c6">)</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>            </span><span class="token control-flow" style="color:#96CBFE">return</span><span> nodes</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>        </span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
<span>        </span><span class="token control-flow" style="color:#96CBFE">if</span><span> </span><span class="token" style="color:#c5c8c6">(</span><span>headingLvl </span><span class="token" style="color:#EDEDED">===</span><span> desiredLvl</span><span class="token" style="color:#c5c8c6">)</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>            node</span><span class="token" style="color:#c5c8c6">.</span><span class="token property-access">children</span><span> </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token" style="color:#DAD085">createTocTreeFrom</span><span class="token" style="color:#c5c8c6">(</span><span>headings</span><span class="token" style="color:#c5c8c6">.</span><span class="token method property-access" style="color:#DAD085">slice</span><span class="token" style="color:#c5c8c6">(</span><span>i </span><span class="token" style="color:#EDEDED">+</span><span> </span><span class="token" style="color:#FF73FD">1</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">,</span><span> desiredLvl </span><span class="token" style="color:#EDEDED">+</span><span> </span><span class="token" style="color:#FF73FD">1</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>            nodes</span><span class="token" style="color:#c5c8c6">.</span><span class="token method property-access" style="color:#DAD085">push</span><span class="token" style="color:#c5c8c6">(</span><span>node</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>        </span><span class="token" style="color:#c5c8c6">}</span><span>
</span><span>    </span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#96CBFE">return</span><span> nodes</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span></span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
</code></pre></pre>
<h1 id="how-to-display-the-toc">How to display the toc</h1>
<h2 id="plain-javascript--typescript">Plain JavaScript / Typescript</h2>
<pre><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code class="language-typescript" style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#96CBFE">function</span><span> </span><span class="token" style="color:#DAD085">displayToc</span><span class="token" style="color:#c5c8c6">(</span><span>entries</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">TocTreeNode</span><span class="token" style="color:#c5c8c6">[</span><span class="token" style="color:#c5c8c6">]</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">HTMLElement</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>    </span><span class="token" style="color:#96CBFE">const</span><span> listElm </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token dom" style="color:#C6C5FE">document</span><span class="token" style="color:#c5c8c6">.</span><span class="token method property-access" style="color:#DAD085">createElement</span><span class="token" style="color:#c5c8c6">(</span><span class="token" style="color:#A8FF60">&quot;ul&quot;</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>    listElm</span><span class="token" style="color:#c5c8c6">.</span><span class="token property-access">style</span><span class="token" style="color:#c5c8c6">.</span><span class="token property-access">marginLeft</span><span> </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token" style="color:#A8FF60">&quot;1em&quot;</span><span class="token" style="color:#c5c8c6">;</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#96CBFE">for</span><span> </span><span class="token" style="color:#c5c8c6">(</span><span class="token" style="color:#96CBFE">const</span><span> entry </span><span class="token" style="color:#96CBFE">of</span><span> entries</span><span class="token" style="color:#c5c8c6">)</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>        </span><span class="token" style="color:#96CBFE">const</span><span> entryElm </span><span class="token" style="color:#EDEDED">=</span><span> </span><span class="token dom" style="color:#C6C5FE">document</span><span class="token" style="color:#c5c8c6">.</span><span class="token method property-access" style="color:#DAD085">createElement</span><span class="token" style="color:#c5c8c6">(</span><span class="token" style="color:#A8FF60">&quot;li&quot;</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>        entryElm</span><span class="token" style="color:#c5c8c6">.</span><span class="token method property-access" style="color:#DAD085">append</span><span class="token" style="color:#c5c8c6">(</span><span>entry</span><span class="token" style="color:#c5c8c6">.</span><span class="token property-access">text</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span>
<span>        </span><span class="token control-flow" style="color:#96CBFE">if</span><span> </span><span class="token" style="color:#c5c8c6">(</span><span>entry</span><span class="token" style="color:#c5c8c6">.</span><span class="token property-access">children</span><span class="token" style="color:#c5c8c6">.</span><span class="token property-access">length</span><span> </span><span class="token" style="color:#EDEDED">&gt;</span><span> </span><span class="token" style="color:#FF73FD">0</span><span class="token" style="color:#c5c8c6">)</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>            entryElm</span><span class="token" style="color:#c5c8c6">.</span><span class="token method property-access" style="color:#DAD085">appendChild</span><span class="token" style="color:#c5c8c6">(</span><span class="token" style="color:#DAD085">displayToc</span><span class="token" style="color:#c5c8c6">(</span><span>entry</span><span class="token" style="color:#c5c8c6">.</span><span class="token property-access">children</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>        </span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
<span>        listElm</span><span class="token" style="color:#c5c8c6">.</span><span class="token method property-access" style="color:#DAD085">appendChild</span><span class="token" style="color:#c5c8c6">(</span><span>entryElm</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span>    </span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#96CBFE">return</span><span> listElm</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span></span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
</code></pre></pre>
<h2 id="react">React</h2>
<pre><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code class="language-tsx" style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#96CBFE">function</span><span> </span><span class="token maybe-class-name" style="color:#DAD085">TableOfContents</span><span class="token" style="color:#c5c8c6">(</span><span class="token parameter" style="color:#c5c8c6">{</span><span class="token parameter"> nodes </span><span class="token parameter" style="color:#c5c8c6">}</span><span class="token parameter" style="color:#EDEDED">:</span><span class="token parameter"> </span><span class="token parameter maybe-class-name">TableOfContentsProps</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#EDEDED">:</span><span> </span><span class="token maybe-class-name">ReactElement</span><span> </span><span class="token" style="color:#c5c8c6">{</span><span>
</span><span>    </span><span class="token control-flow" style="color:#96CBFE">return</span><span> </span><span class="token" style="color:#c5c8c6">(</span><span>
</span><span>        </span><span class="token" style="color:#c5c8c6">&lt;</span><span class="token" style="color:#96CBFE">ul</span><span class="token" style="color:#96CBFE"> </span><span class="token" style="color:#A8FF60">style</span><span class="token script language-javascript script-punctuation" style="color:#96CBFE">=</span><span class="token script language-javascript" style="color:#c5c8c6">{</span><span class="token script language-javascript" style="color:#c5c8c6">{</span><span class="token script language-javascript" style="color:#96CBFE"> marginLeft</span><span class="token script language-javascript" style="color:#EDEDED">:</span><span class="token script language-javascript" style="color:#96CBFE"> </span><span class="token script language-javascript" style="color:#A8FF60">&quot;1em&quot;</span><span class="token script language-javascript" style="color:#96CBFE"> </span><span class="token script language-javascript" style="color:#c5c8c6">}</span><span class="token script language-javascript" style="color:#c5c8c6">}</span><span class="token" style="color:#c5c8c6">&gt;</span><span class="token plain-text">
</span><span class="token plain-text">            </span><span class="token" style="color:#c5c8c6">{</span><span>nodes</span><span class="token" style="color:#c5c8c6">.</span><span class="token method property-access" style="color:#DAD085">map</span><span class="token" style="color:#c5c8c6">(</span><span class="token" style="color:#c5c8c6">(</span><span class="token parameter">node</span><span class="token" style="color:#c5c8c6">)</span><span> </span><span class="token arrow" style="color:#EDEDED">=&gt;</span><span> </span><span class="token" style="color:#c5c8c6">(</span><span>
</span><span>                </span><span class="token" style="color:#c5c8c6">&lt;</span><span class="token" style="color:#c5c8c6">&gt;</span><span class="token plain-text">
</span><span class="token plain-text">                    </span><span class="token" style="color:#c5c8c6">&lt;</span><span class="token" style="color:#96CBFE">li</span><span class="token" style="color:#c5c8c6">&gt;</span><span class="token" style="color:#c5c8c6">{</span><span>node</span><span class="token" style="color:#c5c8c6">.</span><span class="token property-access">text</span><span class="token" style="color:#c5c8c6">}</span><span class="token" style="color:#c5c8c6">&lt;/</span><span class="token" style="color:#96CBFE">li</span><span class="token" style="color:#c5c8c6">&gt;</span><span class="token plain-text">
</span><span class="token plain-text">                    </span><span class="token" style="color:#c5c8c6">{</span><span>node</span><span class="token" style="color:#c5c8c6">.</span><span class="token property-access">children</span><span> </span><span class="token" style="color:#EDEDED">&amp;&amp;</span><span> </span><span class="token" style="color:#c5c8c6">&lt;</span><span class="token" style="color:#FFFFB6;text-decoration:underline">TableOfContents</span><span class="token" style="color:#96CBFE"> </span><span class="token" style="color:#A8FF60">nodes</span><span class="token script language-javascript script-punctuation" style="color:#96CBFE">=</span><span class="token script language-javascript" style="color:#c5c8c6">{</span><span class="token script language-javascript" style="color:#96CBFE">node</span><span class="token script language-javascript" style="color:#c5c8c6">.</span><span class="token script language-javascript property-access" style="color:#96CBFE">children</span><span class="token script language-javascript" style="color:#c5c8c6">}</span><span class="token" style="color:#96CBFE"> </span><span class="token" style="color:#c5c8c6">/&gt;</span><span class="token" style="color:#c5c8c6">}</span><span class="token plain-text">
</span><span class="token plain-text">                </span><span class="token" style="color:#c5c8c6">&lt;/</span><span class="token" style="color:#c5c8c6">&gt;</span><span>
</span><span>            </span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">}</span><span class="token plain-text">
</span><span class="token plain-text">        </span><span class="token" style="color:#c5c8c6">&lt;/</span><span class="token" style="color:#96CBFE">ul</span><span class="token" style="color:#c5c8c6">&gt;</span><span>
</span><span>    </span><span class="token" style="color:#c5c8c6">)</span><span class="token" style="color:#c5c8c6">;</span><span>
</span><span></span><span class="token" style="color:#c5c8c6">}</span><span>
</span>
</code></pre></pre></div><nav class="tableOfContentsLayout_toc__ZjzLh" aria-label="Table of contents"><ul class="tableOfContents_list__b8d6s"></ul></nav></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/bits/toc","query":{},"buildId":"HFqsTIh8NfeB1KISpc7lS","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>